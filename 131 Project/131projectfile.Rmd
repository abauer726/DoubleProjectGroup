---
title: "131projectfile"
output: html_document
---

```{r, echo=FALSE}
library(spotifyr)
library(tidyverse)
library(knitr)
library(lubridate)
library(httpuv)
library(cluster)
library(factoextra)
library(data.table)
library(dplyr)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
music <- read.csv("/Users/lexnavarra/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv")

View(music)


# New research question: can we predict if a song will be a hit based on its attributes? Response variable: song.hotttnesss 
# anna path name: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv
```

```{r}
# randomly subset syntax, with 100 points (couldnt run this due to the file not loading)

# anna path name music: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# anna path name music w genre: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv


# grant path name music: /Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# grant path name music w genre: /Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv

# lex path name music: /Users/lexnavarra/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# lex path name music w genre: /Users/lexnavarra/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv
```


```{r}
# creating a new numeric variable for specific artist average popularity
artist_pop_table <- aggregate(music$popularity, list(music$artists), FUN = mean)

full_merge <- merge(x = music, y = artist_pop_table, by.x = c("artists"), by.y = c("Group.1"), all.x = TRUE)

full_data <- rename(full_merge, avg_art_pop = x)

View(full_data)
```

```{r}
set.seed((123))
# sample data to use for exploratory graphics
sample <- full_data[sample(nrow(full_data), 100), ]
View(sample)
```

```{r pressure, echo=T}
# some EDA plots to decide which predictor to add into our recipe
valence <- ggplot(sample, aes(x=valence, y=popularity)) + geom_point()
valence

year <- ggplot(sample, aes(x=year, y = popularity)) + geom_point()
year

acousticness <- ggplot(sample, aes(x=acousticness, y=popularity)) + geom_point()
acousticness

danceability <- ggplot(sample, aes(x=danceability, y=popularity)) + geom_point()
danceability

duration <- ggplot(sample, aes(x=duration_ms, y=popularity)) + geom_point()
duration

energy <- ggplot(sample, aes(x=energy, y=popularity)) + geom_point()
energy

explicit <- ggplot(sample, aes(x=explicit, y = popularity)) + geom_bar(stat='identity') + scale_x_discrete(breaks=0:1, labels=c("Clean", "Explicit"))
explicit

instrumentalness <- ggplot(sample, aes(x=instrumentalness, y=popularity)) + geom_point()
instrumentalness

key <- ggplot(sample, aes(x=key, y = popularity)) + geom_bar(stat='identity') + scale_x_discrete(breaks=0:11,
              labels=c("C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"))
key

liveness <- ggplot(sample, aes(x=liveness, y=popularity)) + geom_point()
liveness

loudness <- ggplot(sample, aes(x=loudness, y=popularity)) + geom_point()
loudness

mode <- ggplot(sample, aes(x=mode, y = popularity)) + geom_bar(stat='identity') + scale_x_discrete(breaks=0:1,
              labels=c("Minor", "Major"))
mode

speechiness <- ggplot(sample, aes(x=speechiness, y=popularity)) + geom_point()
speechiness

tempo <- ggplot(sample, aes(x=tempo, y=popularity)) + geom_point()
tempo

avg_art_pop <- ggplot(sample, aes(x=avg_art_pop, y=popularity)) + geom_point()
avg_art_pop

# columns not included = artists, id, name, release_date
```


```{r}
# split training and testing data

#set seed
set.seed(123)
# Sample 700 observations as training data 
trainsample = sort(sample(nrow(full_data), nrow(full_data)*.7))
# define dat.train as the 700 observstions 
train = full_data[trainsample,]
# The rest as test data
test = full_data[-trainsample,]
```

```{r}
# make recipe 
```