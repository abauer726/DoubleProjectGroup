---
title: "131projectfile"
output: html_document
---

```{r, echo=FALSE}
library(spotifyr)
library(tidyverse)
library(knitr)
library(lubridate)
library(httpuv)
library(cluster)
library(factoextra)
library(data.table)
library(dplyr)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
music <- read.csv("/Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv")
musicwgenre <- read.csv("/Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv")
View(music)


# New research question: can we predict if a song will be a hit based on its attributes? Response variable: song.hotttnesss 
# anna path name: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv
```

```{r}
# randomly subset syntax, with 100 points (couldnt run this due to the file not loading)

# anna path name music: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# anna path name music w genre: /Users/kimbauer/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv


# grant path name music: /Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# grant path name music w genre: /Users/Grant/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv

# lex path name music: /Users/lexnavarra/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/musicdata.csv
# lex path name music w genre: /Users/lexnavarra/Desktop/DoubleProjectGroup/131 Project/Spotify Dataset/data_w_genres.csv
sample <- music[sample(nrow(music), 100), ]
sample2 <- musicwgenre[sample(nrow(musicwgenre),100), ]
View(sample2)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=T}
energy <- ggplot(sample,aes(x=energy,y=popularity))+geom_point()
energy

liveness <- ggplot(sample,aes(x=liveness, y=popularity))+geom_point()
liveness

danceability <- ggplot(sample, aes(x=danceability, y=popularity))+geom_point()
danceability

key <- ggplot(sample, aes(x=key, y = popularity))+geom_bar(stat='identity')
key

explicit <- ggplot(sample, aes(x=explicit, y = popularity)) + geom_bar(stat='identity') + scale_x_discrete(breaks=0:1,
              labels=c("Clean", "Explicit"))
explicit

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}
#set seed
set.seed(123)
# Sample 700 observations as training data 
trainsample = sort(sample(nrow(music), nrow(music)*.7))
# define dat.train as the 700 observstions 
train = music[trainsample,]
# The rest as test data
test = music[-trainsample,]

```


```{r}
artist_pop_table <- aggregate(train$popularity, list(train$artists), FUN = mean)
artist_pop_table
# train_mod1 = train %>%
#   mutate(artist_avg_pop = aggregate(.~artists,data=train,mean))
# 
# fit <- lm(popularity ~ year + artist_avg_pop + valence + acousticness + duration_ms + explicit + instrumentalness + key + liveness + loudness + mode + speechiness + tempo + danceability + energy, data = train_mod1)
# 
# summary(fit)

artist_pop_table$Group.1 <- toString(artist_pop_table$Group.1)
# music$artists <- toString(music$artists)
artist_pop_table
# 
# train$artist_popularity <- 0
# for (artist in train$artists){
#   if (artist_pop_table$Group.1 == artist){
#     train$artist_popularity = artist_pop_table$x
#   }
# }
```



